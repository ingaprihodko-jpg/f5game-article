<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>F5GAME –ê–≤—Ç–æ—Ä—Å–∫–∞—è –ü–∞–Ω–µ–ª—å</title>
<style>
:root {
  --brand-purple: #390084; --accent-pink: #ED1E79; --accent-cyan: #20BAEF; --accent-green: #2AA817;
  --bg-main: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  --bg-card: #ffffff; --text-primary: #212529; --border-color: #dee2e6;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Roboto, sans-serif; background: var(--bg-main); padding: 20px; }
.container { max-width: 1200px; margin: 0 auto; }
header { text-align: center; padding: 20px 0; border-bottom: 3px solid var(--accent-pink); margin-bottom: 30px; }
.logo { font-size: 2rem; font-weight: 900; background: linear-gradient(45deg, var(--brand-purple), var(--accent-cyan)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.control-panel { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 16px; padding: 25px; margin-bottom: 30px; }
input, textarea { width: 100%; padding: 12px; margin: 8px 0; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1rem; }
textarea { min-height: 200px; resize: vertical; }
button { padding: 12px 24px; margin: 5px; border: none; border-radius: 8px; background: var(--accent-pink); color: white; font-weight: bold; cursor: pointer; transition: all 0.3s; }
button:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(237,30,121,0.4); }
.btn-publish { background: var(--accent-green); }
#statusMessage { margin-top: 15px; padding: 12px; border-radius: 8px; display: none; }
.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
.article-item { border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 10px 0; background: white; }
.status-draft { border-left: 4px solid #ffc107; }
.status-published { border-left: 4px solid #28a745; }
</style>
</head>
<body>
<div class="container">
<header>
<h1 class="logo">F5GAME –ê–≤—Ç–æ—Ä—Å–∫–∞—è –ü–∞–Ω–µ–ª—å</h1>
<p>–ü—Ä–æ—Å—Ç–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å—Ç–∞—Ç–µ–π</p>
</header>

<div class="control-panel">
<h2>üìù –ù–æ–≤–∞—è —Å—Ç–∞—Ç—å—è</h2>
<input type="text" id="articleTitle" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫">
<textarea id="articleContent" placeholder="–¢–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏"></textarea>
<button class="btn-publish" onclick="publishArticle()">üöÄ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
<div id="statusMessage"></div>
</div>
</div>

<script>
const GITHUB_TOKEN = 'MY_TOKEN_RIGHT'; // –í–°–¢–ê–í–¨–¢–ï –°–í–û–ô –¢–û–ö–ï–ù
const GITHUB_OWNER = 'ingaprihodko-jpg';
const GITHUB_REPO = 'f5game-article';

async function publishArticle() {
  const title = document.getElementById('articleTitle').value.trim();
  const content = document.getElementById('articleContent').value.trim();

  if (!title || !content) {
    showStatus('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ!', 'error');
    return;
  }

  const article = {
    id: Date.now(),
    title,
    content: formatText(content),
    status: 'published',
    createdAt: new Date().toISOString()
  };

  const articles = JSON.parse(localStorage.getItem('f5game_articles_v3') || '[]');
  articles.push(article);
  localStorage.setItem('f5game_articles_v3', JSON.stringify(articles));

  try {
    const jsonData = JSON.stringify(articles, null, 2);
    const content = btoa(unescape(encodeURIComponent(jsonData)));

    const checkRes = await fetch(`https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/articles.json`, {
      headers: { 'Authorization': `token ${GITHUB_TOKEN}` }
    });

    let sha = '';
    if (checkRes.ok) {
      const data = await checkRes.json();
      sha = data.sha;
    }

    const response = await fetch(`https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/articles.json`, {
      method: 'PUT',
      headers: {
        'Authorization': `token ${GITHUB_TOKEN}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        message: `Auto-publish: ${articles.length} —Å—Ç–∞—Ç–µ–π`,
        content: content,
        branch: "main",
        sha: sha || undefined
      })
    });

    if (!response.ok) throw new Error('API –æ—à–∏–±–∫–∞: ' + response.status);

    showStatus('‚úÖ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ! –°–∞–π—Ç –æ–±–Ω–æ–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ 30-60 —Å–µ–∫', 'success');
  } catch (error) {
    showStatus('‚ùå ' + error.message, 'error');
  }
}

function formatText(text) {
  if (!text || text.includes('<div')) return text;
  const lines = text.split('\n').map(l => l.trim()).filter(l => l);
  let html = '';

  lines.forEach(line => {
    if (line === line.toUpperCase() && line.length > 5 && !line.startsWith('‚Ä¢')) {
      html += `<h2 style="color:#390084;margin:25px 0 15px;">${line}</h2>`;
    } else if (line.startsWith('‚Ä¢')) {
      html += `<li style="margin-left:30px;color:#20BAEF;font-weight:600;">‚Üí ${line.substring(1)}</li>`;
    } else if (line.match(/^(–ü—Ä–∏–º–µ—Ä|–í–ê–ñ–ù–û|–ö–ï–ô–°):?\s*(.+)/i)) {
      const [, type, content] = line.match(/^(–ü—Ä–∏–º–µ—Ä|–í–ê–ñ–ù–û|–ö–ï–ô–°):?\s*(.+)/i);
      html += `<div style="background:#fff5f5;border-left:4px solid #ED1E79;padding:20px;margin:20px 0;border-radius:8px;">
        <strong style="color:#ED1E79;">${type}:</strong> ${content}
      </div>`;
    } else {
      html += `<p style="line-height:1.7;margin-bottom:15px;">${line}</p>`;
    }
  });
  return html;
}

function showStatus(msg, type) {
  const status = document.getElementById('statusMessage');
  status.textContent = msg;
  status.className = type;
  status.style.display = 'block';
  setTimeout(() => status.style.display = 'none', 5000);
}
</script>
</body>
</html>
